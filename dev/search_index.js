var documenterSearchIndex = {"docs":
[{"location":"tutorials/baffled_piston_tut.html#Baffled-piston-in-a-half-sphere-domain","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"","category":"section"},{"location":"tutorials/baffled_piston_tut.html#Description","page":"Baffled piston in a half-sphere domain","title":"Description","text":"","category":"section"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Baffled piston in a half-sphere domain with Absorbing Boundary Condition (ABC).","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"(Image: )","category":"page"},{"location":"tutorials/baffled_piston_tut.html#Goals","page":"Baffled piston in a half-sphere domain","title":"Goals","text":"","category":"section"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Demonstrate the use of an algorithm to run the simulation.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"#","category":"page"},{"location":"tutorials/baffled_piston_tut.html#Definitions","page":"Baffled piston in a half-sphere domain","title":"Definitions","text":"","category":"section"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"The finite element code relies on the basic functionality implemented in this package.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"using FinEtools","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"The acoustics functionality is brought in:","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"using FinEtoolsAcoustics","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"We shall need some facilities from the linear algebra package","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"using LinearAlgebra","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"The input quantities are provided including the units:","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"rho = 1.21*phun(\"kg/m^3\");# mass density\nc  = 343.0*phun(\"m/s\");# sound speed\nbulk =  c^2*rho;\nomega =  7500*phun(\"rev/s\");      # frequency of the piston\na_piston =  -1.0*phun(\"mm/s\")     # amplitude of the piston acceleration\nR = 50.0*phun(\"mm\");# radius of the piston\nRo = 150.0*phun(\"mm\"); # radius of the enclosure\nnref = 4;#number of refinements of the sphere around the piston\nnlayers = 35;                     # number of layers of elements surrounding the piston\ntolerance = R/(2^nref)/100","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Hexahedral mesh","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"fens,fes  =  H8sphere(R,nref);\nbfes  =  meshboundary(fes)\nFile  =   \"baffledabc_boundary.vtk\"\nvtkexportmesh(File, connasarray(bfes), fens.xyz, FinEtools.MeshExportModule.VTK.Q4)\n@async run(`\"paraview.exe\" $File`)\n\nl = selectelem(fens, bfes, facing = true, direction = [1.0 1.0  1.0], dotmin= 0.001)\nex(xyz, layer) = (R+layer/nlayers*(Ro-R))*xyz/norm(xyz)\nfens1, fes1  =  H8extrudeQ4(fens, subset(bfes,l), nlayers, ex);\nfens, newfes1, fes2 =  mergemeshes(fens1, fes1, fens, fes, tolerance)\nfes = cat(newfes1,fes2)","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Piston surface mesh","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"bfes  =  meshboundary(fes)\nl1 = selectelem(fens, bfes, facing = true, direction = [-1.0 0.0 0.0])\nl2 = selectelem(fens, bfes, distance = R, from = [0.0 0.0 0.0], inflate = tolerance)\npiston_fes = subset(bfes,intersect(l1,l2));","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Outer spherical boundary","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"louter = selectelem(fens, bfes, facing = true, direction = [1.0 1.0  1.0], dotmin= 0.001)\nouter_fes = subset(bfes,louter);","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"The simulation is driven by setting up and then executing an algorithm. For this purpose we store the data in a \"model data dictionary\".","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Region of the fluid. Define the finite element machine for the fluid region.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"material = MatAcoustFluid(bulk, rho)\nregion1 =  FDataDict(\"femm\"=>FEMMAcoust(IntegDomain(fes, GaussRule(3, 2)), material))","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Define the finite element machine for the ABC (absorbing boundary condition).","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"abc1  =  FDataDict(\"femm\"=>FEMMAcoustSurf(IntegDomain(outer_fes, GaussRule(2, 2)), material))","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"The normal flux is prescribed on the surface of the piston in terms of the known acceleration.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"flux1  =  FDataDict(\"femm\"=>FEMMAcoustSurf(IntegDomain(piston_fes, GaussRule(2, 2)), material),  \"normal_flux\"=> -rho*a_piston+0.0im);","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Make model data dictionary. It completely defines the parameters of the problem.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"modeldata =  FDataDict(\"fens\"=>fens, \"omega\"=>omega, \"regions\"=>[region1], \"flux_bcs\"=>[flux1], \"ABCs\"=>[abc1])","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Call the solver. The model data is returned enriched of the solution parameters, such as the pressure field P.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"modeldata = FinEtoolsAcoustics.AlgoAcoustModule.steadystate(modeldata)","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Extract geometry field and the pressure field for postprocessing.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"geom = modeldata[\"geom\"]\nP = modeldata[\"P\"]","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"Write out the postprocessing data is a VTK file. Dump both the magnitude and the components of the solution (complex field).","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"File  =   \"baffledabc.vtk\"\nvtkexportmesh(File, connasarray(fes), geom.values, FinEtools.MeshExportModule.VTK.H8; scalars = [(\"absP\", abs.(P.values)), (\"realP\", real.(P.values)), (\"imagP\", imag.(P.values))])","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"If the paraview program is installed, run it.","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"@async run(`\"paraview.exe\" $File`)\n\ntrue","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"","category":"page"},{"location":"tutorials/baffled_piston_tut.html","page":"Baffled piston in a half-sphere domain","title":"Baffled piston in a half-sphere domain","text":"This page was generated using Literate.jl.","category":"page"},{"location":"tutorials/tutorials.html","page":"Tutorials","title":"Tutorials","text":"Table of contents","category":"page"},{"location":"tutorials/tutorials.html#Tutorials","page":"Tutorials","title":"Tutorials","text":"","category":"section"},{"location":"tutorials/tutorials.html","page":"Tutorials","title":"Tutorials","text":"Modes in a rigid box\nAcoustic field of a baffled piston\nPressure field of a translating sphere","category":"page"},{"location":"index.html#FinEtoolsAcousticsTutorials-Documentation","page":"Home","title":"FinEtoolsAcousticsTutorials Documentation","text":"","category":"section"},{"location":"index.html#Tutorials","page":"Home","title":"Tutorials","text":"","category":"section"},{"location":"index.html","page":"Home","title":"Home","text":"The tutorials are provided in the form of Julia scripts and Markdown files. ","category":"page"},{"location":"tutorials/rigid_box_tut.html#Modal-analysis-of-acoustic-medium-in-a-rigid-box","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"","category":"section"},{"location":"tutorials/rigid_box_tut.html#Description","page":"Modal analysis of acoustic medium in a rigid box","title":"Description","text":"","category":"section"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"Example from Boundary element acoustics: Fundamentals and computer codes, TW Wu, page 123. Internal resonance problem. Reference frequencies: 90.7895, 181.579, 215.625, 233.959, 272.368, 281.895 Quadrilateral mesh.","category":"page"},{"location":"tutorials/rigid_box_tut.html#Goals","page":"Modal analysis of acoustic medium in a rigid box","title":"Goals","text":"","category":"section"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"Construct the discrete model and solve the eigenvalue problem for the natural frequencies.\nVisualize eigenmodes.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"#","category":"page"},{"location":"tutorials/rigid_box_tut.html#Definitions","page":"Modal analysis of acoustic medium in a rigid box","title":"Definitions","text":"","category":"section"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"The finite element code realize on the basic functionality implemented in this package.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"using FinEtools","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"The acoustics functionality is brought in:","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"using FinEtoolsAcoustics","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"In order to solve the eigenvalue problem we need the Arnoldi package.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"import Arpack: eigs","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"The input quantities are provided without units, but the units are consistent:","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"rho = 1.21*1e-9;# mass density\nc  = 345.0*1000;# millimeters per second\nbulk =  c^2*rho;\nLx = 1900.0;# length of the box, millimeters\nLy = 800.0; # length of the box, millimeters\nn = 14;#\nneigvs = 18;\nOmegaShift = 10.0;","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"The mesh covers a rectangle.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"fens,fes = Q4block(Lx,Ly,n,n); # Mesh","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"Construct the geometry and the pressure field.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"geom = NodalField(fens.xyz)\nP = NodalField(zeros(size(fens.xyz,1),1))","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"There are no boundary conditions explicitly needed: The box has hard sound boundary conditions all around. Number the unknowns in the pressure field.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"numberdofs!(P)","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"The finite element machine for acoustics is constructed. The integration rule is appropriate to the four node quadrilaterals.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"femm = FEMMAcoust(IntegDomain(fes, GaussRule(2, 2)), MatAcoustFluid(bulk,rho))","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"Compute the stiffness and mass matrices:","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"S = acousticstiffness(femm, geom, P);\nC = acousticmass(femm, geom, P);","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"And now solves eigenvalue problem. Note that the acoustic mass is singular, and we need to use shifting to ensure convertibility of the first matrix.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"evals, evecs, nconv = eigs(C+OmegaShift*S, S; nev=neigvs, which=:SM)\nevals = evals .- OmegaShift;\nfs = real(sqrt.(complex(evals)))./(2*pi)\nprintln(\"Eigenvalues: $fs [Hz]\")","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"Postprocessing: export all pressure modes.","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"File =  \"rigid_box.vtk\"\nscalarllist = Any[]\nfor n  = 1:15\n    push!(scalarllist, (\"Pressure_mode_$n\", evecs[:,n]));\nend\nvtkexportmesh(File, connasarray(fes), geom.values, FinEtools.MeshExportModule.VTK.Q4;\nscalars=scalarllist)\n@async run(`\"paraview.exe\" $File`)\n\ntrue","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"","category":"page"},{"location":"tutorials/rigid_box_tut.html","page":"Modal analysis of acoustic medium in a rigid box","title":"Modal analysis of acoustic medium in a rigid box","text":"This page was generated using Literate.jl.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Moving-sphere-in-an-infinite-fluid","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html#Description","page":"Moving sphere in an infinite fluid","title":"Description","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"A rigid sphere in an infinite volume of fluid accelerates alternately in the positive and negative x-direction, generating positive pressure ahead of it, negative pressure behind. Time-dependent simulation. Described in [1].","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#References","page":"Moving sphere in an infinite fluid","title":"References","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"[1] Krysl P, Hawkins AD, Schilt C, Cranford TW (2012): Angular Oscillation of Solid Scatterers in Response to Progressive Planar Acoustic Waves: Do Fish Otoliths Rock?. PLOS ONE 7(8): e42591. https://doi.org/10.1371/journal.pone.0042591","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"(Image: )","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Goals","page":"Moving sphere in an infinite fluid","title":"Goals","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Show how to generate hexahedral mesh, mirroring and merging together parts.\nExecute transient simulation by the trapezoidal-rule time stepping of [1].","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"#","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Definitions","page":"Moving sphere in an infinite fluid","title":"Definitions","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The finite element code relies on the basic functionality implemented in this package.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"using FinEtools","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The acoustics functionality is brought in:","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"using FinEtoolsAcoustics","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"We shall need some facilities from the linear algebra package","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"using LinearAlgebra","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The properties correspond roughly to air.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"rho = 1.21*phun(\"kg/m^3\");# mass density\nc  = 343.0*phun(\"m/s\");# sound speed\nbulk =  c^2*rho;\na_amplitude=1.0*phun(\"mm/s^2\");# amplitude of the  acceleration of the sphere\nR = 50.0*phun(\"mm\"); # radius of the interior sphere\nRo = 8*R # radius of the external sphere, where the fluid doing this truncated\nP_amplitude = R*rho*a_amplitude; # pressure amplitude\nfrequency = 1200.; # # frequency of the incident wave, Hz\nomega = 2*pi*frequency;\ndt = 1.0/frequency/20;\ntfinal = 90*dt;\nnsteps = round(tfinal/dt)+1;","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"This dictates the parameters of the mesh.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"nref = 2;\nnlayers = 40;\ntolerance  =  Ro/(nlayers)/100","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Hexahedral mesh: Generate 1/8 of the scattering sphere. This sphere is not actually part of the model, it just serves as an intermediate step from which the volume of the fluid will be produced.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"fens, fes  =  H8sphere(R, nref);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"No mirror the 1/8 of the sphere to build one fourth of the complete three-dimensional geometry. In other words we are using two symmetric planes here. Note that in order to mirror the hexahedral elements correctly, we need to specify the renumbering rule for the connectivity.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"fens1, fes1  =  mirrormesh(fens, fes, [-1.0, 0.0, 0.0], [0.0, 0.0, 0.0], renumb =  r(c) = c[[1, 4, 3, 2, 5, 8, 7, 6]]);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Now merge the two pieces (1/8) together.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"fens,newfes1,fes2 =  mergemeshes(fens1, fes1, fens, fes, tolerance)\nfes = cat(newfes1,fes2)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Derive the finite element set for the boundary of the target.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"bfes  =  meshboundary(fes)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"To identify the outer spherical boundary we'll use this function to calculate its normal.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"function dout(xyz)\n    return xyz/norm(xyz)\nend","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Select the part of the boundary of the target facing towards infinity.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"louter = selectelem(fens, bfes, facing = true, direction = dout)\nouter_fes = subset(bfes, louter);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The surface of the spherical target is now extruded into multiple layers.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"fens,fes  = H8extrudeQ4(fens, outer_fes, nlayers, (xyz, layer)->(R+layer/nlayers*(Ro-R))*xyz/norm(xyz));","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"In case there are any unconnected nodes, remove them, and renumber the elements.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"connected = findunconnnodes(fens, fes);\nfens, new_numbering = compactnodes(fens, connected);\nfess = renumberconn!(fes, new_numbering);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The geometry and the solution (pressure) fields.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"geom  =  NodalField(fens.xyz)\nP  =  NodalField(zeros(FCplxFlt,size(fens.xyz,1),1))","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"We need to identify the surface of the scattering sphere, and also the outside sphere where the fluid immediately surrounding the sphere is adjacent to the infinite extent of the fluid.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"bfes  =  meshboundary(fes)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Find the two spherical surfaces, one can be located by the distance criterion (from the center), and the other one by facing to infinity (away from the center).","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"linner = selectelem(fens, bfes, distance = R, from = [0.0 0.0 0.0], inflate = tolerance)\nlouter = selectelem(fens, bfes, facing = true, direction = dout)\n\n#","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Visualize-the-geometry","page":"Moving sphere in an infinite fluid","title":"Visualize the geometry","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Export three VTK files: one for the interior of the fluid, and two for the boundaries. The boundaries on the symmetry planes are taken into account implicitly.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"File  =   \"Sphere-fluid-interior.vtk\"\nvtkexportmesh(File, fes.conn, fens.xyz, FinEtools.MeshExportModule.VTK.H8)\nFile  =   \"Sphere-fluid-inner-boundary.vtk\"\nvtkexportmesh(File, subset(bfes, linner).conn, geom.values, FinEtools.MeshExportModule.VTK.Q4)\nFile  =   \"Sphere-fluid-outer-boundary.vtk\"\nvtkexportmesh(File, subset(bfes, louter).conn, geom.values, FinEtools.MeshExportModule.VTK.Q4)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"If we have paraview, we can run it now.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"@async run(`\"paraview.exe\" $File`)\n\n#","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Set-up-the-discrete-model","page":"Moving sphere in an infinite fluid","title":"Set up the discrete model","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Number the degrees of freedom in the pressure field.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"numberdofs!(P)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Create the finite element machine for the fluid.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"material = MatAcoustFluid(bulk,rho)\nfemm  =  FEMMAcoust(IntegDomain(fes, GaussRule(3, 2)), material)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Use the machine calculate the acoustic stiffness and mass matrices.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"S  =  acousticstiffness(femm, geom, P);\nC  =  acousticmass(femm, geom, P);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Set up finite element machine needed for the absorbing boundary conditions.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"abcfemm  =  FEMMAcoustSurf(IntegDomain(subset(bfes, louter), GaussRule(2, 2)), material)","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"This is the \"damping\" mmatrix for the ABC.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"D  =  acousticABC(abcfemm, geom, P);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The sphere at the center is rigid and moves in a prescribed, harmonic, fashion. That generates loading onto the fluid. We expect the loading to be in the form of a dipole.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"function dipole(dpdn, xyz, J, label, t)\n    n = cross(J[:,1],J[:,2]);\n    n = vec(n/norm(n));\n    dpdn[1] = -rho*a_amplitude*sin(omega*t)*n[1]\nend","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"In order to evaluate the distributed pressure flux loading we need a surface acoustic finite element model machine. We shall set it up for the interior spherical surface.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"dipfemm  =  FEMMAcoustSurf(IntegDomain(subset(bfes, linner), GaussRule(2, 2)), material)\n\n#","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Time-stepping","page":"Moving sphere in an infinite fluid","title":"Time stepping","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Solve the transient acoustics equations. Refer to [1] for details of the formulation.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The loop executes inside this local scope.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"P1 = let\n    P0 = deepcopy(P)\n    P0.values[:] .= 0.0; # initially all pressure is zero\n    vP0 = gathersysvec(P0);\n    vQ0 = zeros(eltype(vP0), size(vP0));","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"The P1 field will be the output of this computation: the final value of the pressure field","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"    P1 = deepcopy(P0);\n\n    t = 0.0; # Initial time","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Compute the initial load due to the pressure gradient on the surface of the moving sphere.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"    fi  =  ForceIntensity(FCplxFlt, 1, (dpdn, xyz, J, label)->dipole(dpdn, xyz, J, label, t));\n    La0 = distribloads(dipfemm, geom, P1, fi, 2);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"This is the coefficient matrix that needs to be used in the solves. We are not being very careful here to save on computation: it might be best to factorize this matrix, and then use backward and forward solves inside the loop.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"    A = (2.0/dt)*S + D + (dt/2.)*C;\n\n    step = 0;\n    while t <= tfinal\n        step = step  + 1;\n        println(\"Time $t ($(step)/$(round(tfinal/dt)+1))\")\n        t = t+dt;","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Compute the current load due to the pressure gradient on the surface of the moving sphere.","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"        fi  = ForceIntensity(FCplxFlt, 1, (dpdn, xyz, J, label)->dipole(dpdn, xyz, J, label, t));\n        La1 = distribloads(dipfemm, geom, P1, fi, 2);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Solve for the rate of the pressure","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"        vQ1 = A\\((2/dt)*(S*vQ0)-D*vQ0-C*(2*vP0+(dt/2)*vQ0)+La0+La1);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Update the value of the pressure","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"        vP1 = vP0 + (dt/2)*(vQ0+vQ1);","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"Swap variables for next step","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"        vP0 = vP1;\n        vQ0 = vQ1;\n        P1 = scattersysvec!(P1, vec(vP1));\n        P0 = P1;\n        La0 = La1;\n    end\n\n    P1 # Return the final pressure\nend\n\n#","category":"page"},{"location":"tutorials/sphere_dipole_tut.html#Visualization","page":"Moving sphere in an infinite fluid","title":"Visualization","text":"","category":"section"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"File  =   \"sphere_dipole_P1.vtk\"\nvtkexportmesh(File, fes.conn, geom.values, FinEtools.MeshExportModule.VTK.H8; scalars = [( \"realP\", real.(P1.values)),])\n@async run(`\"paraview.exe\" $File`)\n\n\ntrue","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"","category":"page"},{"location":"tutorials/sphere_dipole_tut.html","page":"Moving sphere in an infinite fluid","title":"Moving sphere in an infinite fluid","text":"This page was generated using Literate.jl.","category":"page"}]
}
